# Server Configuration
NODE_ENV=development
PORT=3001

# Azure Key Vault Configuration
AZURE_KEY_VAULT_NAME=kv-bcagent-dev
AZURE_TENANT_ID=your-azure-tenant-id
AZURE_CLIENT_ID=your-azure-client-id
AZURE_CLIENT_SECRET=your-azure-client-secret

# Database (Azure SQL - from Key Vault in production)
DATABASE_SERVER=sqlsrv-bcagent-dev.database.windows.net
DATABASE_NAME=sqldb-bcagent-dev
DATABASE_USER=sqladmin
DATABASE_PASSWORD=your-sql-password
# Alternative: Use connection string from Key Vault
# DATABASE_CONNECTION_STRING=<from Key Vault: SqlDb-ConnectionString>

# Redis Cache (from Key Vault in production)
REDIS_HOST=redis-bcagent-dev.redis.cache.windows.net
REDIS_PORT=6380
REDIS_PASSWORD=your-redis-password
# Alternative: Use connection string from Key Vault
# REDIS_CONNECTION_STRING=<from Key Vault: Redis-ConnectionString>

# Anthropic Claude API
ANTHROPIC_API_KEY=<from Key Vault: Claude-ApiKey>
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# Business Central API
BC_API_URL=https://api.businesscentral.dynamics.com/v2.0
BC_TENANT_ID=<from Key Vault: BC-TenantId>
BC_ENVIRONMENT=production

# MCP Server
MCP_SERVER_URL=https://app-erptools-mcp-dev.purplemushroom-befedc5f.westeurope.azurecontainerapps.io/mcp

# JWT Authentication - DEPRECATED
# JWT has been replaced by Microsoft OAuth 2.0 with session-based authentication
# See migration guide: docs-old/05-deprecated/01-jwt-authentication.md
# DO NOT USE - Keep for backward compatibility only
JWT_SECRET=<DEPRECATED - DO NOT USE>
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# Microsoft OAuth 2.0 Authentication (NEW - REQUIRED)
MICROSOFT_CLIENT_ID=<from Azure App Registration or Key Vault: Microsoft-ClientId>
MICROSOFT_CLIENT_SECRET=<from Azure App Registration or Key Vault: Microsoft-ClientSecret>
MICROSOFT_TENANT_ID=common
MICROSOFT_REDIRECT_URI=http://localhost:3002/api/auth/callback
MICROSOFT_SCOPES="openid profile email offline_access User.Read https://api.businesscentral.dynamics.com/Financials.ReadWrite.All"

# Encryption for BC tokens (per-user) (NEW - REQUIRED)
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY=<from Key Vault: ENCRYPTION-KEY or generate locally>

# Session management (NEW - REQUIRED)
# Generate with: openssl rand -base64 32
SESSION_SECRET=<from Key Vault: SESSION-SECRET or generate locally>
SESSION_MAX_AGE=86400000

# Frontend URL (NEW)
FRONTEND_URL=http://localhost:3000

# CORS Configuration
CORS_ORIGIN=http://localhost:3000

# Logging
LOG_LEVEL=debug

# Session Configuration
SESSION_TIMEOUT_MINUTES=30

# Agent Configuration
MAX_CONTEXT_TOKENS=100000
ENABLE_PROMPT_CACHING=true
ENABLE_EXTENDED_THINKING=true

# Storage (Azure Blob Storage - from Key Vault in production)
STORAGE_CONNECTION_STRING=<from Key Vault: Storage-ConnectionString>
STORAGE_CONTAINER_NAME=agent-files

# Queue Configuration (Multi-tenant Rate Limiting)
# Maximum number of jobs a single session can queue per hour
QUEUE_MAX_JOBS_PER_SESSION=100
# Rate limit time window in seconds (3600 = 1 hour)
QUEUE_RATE_LIMIT_WINDOW_SECONDS=3600
# Message persistence worker concurrency
QUEUE_MESSAGE_CONCURRENCY=10
# Tool execution worker concurrency
QUEUE_TOOL_CONCURRENCY=5
# Event processing worker concurrency
QUEUE_EVENT_CONCURRENCY=10
# Max retry attempts for failed jobs
QUEUE_MAX_RETRY_ATTEMPTS=3
# Initial backoff delay for retries in milliseconds
QUEUE_RETRY_INITIAL_DELAY=1000
# Number of completed jobs to keep for debugging
QUEUE_KEEP_COMPLETED=100
# TTL for completed jobs in seconds (3600 = 1 hour)
QUEUE_COMPLETED_TTL=3600
# Number of failed jobs to keep for debugging
QUEUE_KEEP_FAILED=500
# TTL for failed jobs in seconds (86400 = 24 hours)
QUEUE_FAILED_TTL=86400
